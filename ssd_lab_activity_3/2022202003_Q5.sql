SELECT MY_TABLE.Essn, DEPARTMENT.Dnumber, MY_TABLE.DEP_COUNT FROM (SELECT Essn, COUNT(Dependent_name) AS DEP_COUNT FROM DEPENDENT WHERE Essn IN (SELECT Mgr_ssn FROM DEPARTMENT WHERE Dnumber IN (SELECT Dnumber FROM DEPT_LOCATIONS GROUP BY Dnumber HAVING COUNT(Dlocation) > 1)) GROUP BY Essn) AS MY_TABLE INNER JOIN DEPARTMENT ON MY_TABLE.Essn = DEPARTMENT.Mgr_ssn;
